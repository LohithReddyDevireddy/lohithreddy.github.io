import { useEffect, useRef, useState } from "react";
import confetti from "canvas-confetti";

const messages = [
  "‡∞Ö‡∞Æ‡±ç‡∞Æ‡∞æ... ‡∞à ‡∞∞‡±ã‡∞ú‡±Å ‡∞®‡±Ä ‡∞™‡±Å‡∞ü‡±ç‡∞ü‡∞ø‡∞®‡∞∞‡±ã‡∞ú‡±Å!",
      'So, ‡∞™‡±Å‡∞ü‡±ç‡∞ü‡∞ø‡∞®‡∞∞‡±ã‡∞ú‡±Å ‡∞∂‡±Å‡∞≠‡∞æ‡∞ï‡∞æ‡∞Ç‡∞ï‡±ç‡∞∑‡∞≤‡±Å! üíê',
      "‡∞®‡±Ä ‡∞™‡±ç‡∞∞‡±á‡∞Æ‡∞≤‡±ã ‡∞Æ‡±Å‡∞°‡∞ø‡∞™‡∞°‡∞ø‡∞® ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞ú‡±ç‡∞û‡∞æ‡∞™‡∞ï‡∞Ç ‡∞®‡∞æ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞Ö‡∞Æ‡±Ç‡∞≤‡±ç‡∞Ø‡∞Ç.",
      "‡∞à ‡∞ö‡∞ø‡∞®‡±ç‡∞® ‡∞ó‡∞ø‡∞´‡±ç‡∞ü‡±ç ‡∞µ‡±Ü‡∞¨‡±ç‚Äå‡∞∏‡±à‡∞ü‡±ç ‡∞®‡±Ä‡∞ï‡±Å ‡∞í‡∞ï ‡∞ö‡∞ø‡∞∞‡±Å ‡∞®‡∞µ‡±ç‡∞µ‡±Å‡∞®‡±Å ‡∞§‡±Ä‡∞∏‡±Å‡∞ï‡±ä‡∞∏‡±ç‡∞§‡±á ‡∞ö‡∞æ‡∞≤‡±Å.",
      '‡∞à ‡∞™‡±ç‡∞∞‡∞™‡∞Ç‡∞ö‡∞Ç‡∞≤‡±ã ‡∞®‡±Å‡∞µ‡±ç‡∞µ‡±Å ‡∞≤‡±á‡∞®‡∞ø ‡∞∞‡±ã‡∞ú‡±Å ‡∞í‡∞ï‡±ç‡∞ï ‡∞∞‡±ã‡∞ú‡±à‡∞®‡∞æ ‡∞ä‡∞π‡∞ø‡∞Ç‡∞ö‡∞≤‡±á‡∞®‡±Å...',
      '‡∞ö‡∞ø‡∞®‡±ç‡∞®‡∞™‡±ç‡∞™‡∞ü‡∞ø ‡∞®‡±Å‡∞Ç‡∞°‡∞ø ‡∞®‡∞®‡±ç‡∞®‡±Å ‡∞™‡±ç‡∞∞‡±á‡∞Æ‡∞ø‡∞Ç‡∞ö‡∞ø, ‡∞ó‡±Å‡∞Ç‡∞°‡±Ü‡∞§‡±ã ‡∞ï‡∞æ‡∞™‡∞æ‡∞°‡∞ø‡∞® ‡∞®‡±Å‡∞µ‡±ç‡∞µ‡±á ‡∞®‡∞æ ‡∞∞‡∞ø‡∞Ø‡∞≤‡±ç ‡∞π‡±Ä‡∞∞‡±ã‡∞Ø‡∞ø‡∞®‡±ç üíñ',
      '‡∞®‡±Ä ‡∞®‡∞µ‡±ç‡∞µ‡±á ‡∞®‡∞æ‡∞ï‡±Å ‡∞ö‡±Ä‡∞ï‡∞ü‡∞ø‡∞≤‡±ã ‡∞µ‡±Ü‡∞≤‡±Å‡∞ó‡±Å‡∞≤‡∞æ, ‡∞®‡±Ä ‡∞ó‡±Å‡∞Ç‡∞°‡±Ü‡∞®‡±á ‡∞®‡∞æ‡∞ï‡±Å ‡∞≠‡∞¶‡±ç‡∞∞‡∞§ ‡∞ó‡∞¶‡∞ø‡∞≤‡∞æ.',
      '‡∞®‡±á‡∞®‡±Å ‡∞é‡∞ï‡±ç‡∞ï‡∞°‡±à‡∞®‡∞æ, ‡∞é‡∞™‡±ç‡∞™‡±Å‡∞°‡±à‡∞®‡∞æ ‡∞®‡±Ä ‡∞™‡±ç‡∞∞‡±á‡∞Æ‡∞ï‡∞ø ‡∞é‡∞¶‡±Å‡∞∞‡±Å ‡∞≤‡±á‡∞¶‡±Å.',
      '‡∞í‡∞ï‡±ç‡∞ï‡∞∏‡∞æ‡∞∞‡∞ø ‡∞µ‡±Ü‡∞®‡∞ï‡±ç‡∞ï‡∞ø ‡∞§‡∞ø‡∞∞‡∞ø‡∞ó‡∞ø ‡∞ö‡±Ç‡∞∏‡±ç‡∞§‡±á, ‡∞®‡±Ä ‡∞™‡±ç‡∞∞‡±á‡∞Æ ‡∞Æ‡±Å‡∞¶‡±ç‡∞¶‡±Å‡∞≤‡±á ‡∞®‡∞®‡±ç‡∞®‡±Å ‡∞®‡∞ø‡∞≤‡∞¨‡±Ü‡∞ü‡±ç‡∞ü‡∞æ‡∞Ø‡∞ø.',
      '‡∞à ‡∞ú‡∞®‡±ç‡∞Æ‡∞≤‡±ã ‡∞®‡∞æ‡∞ï‡±Å ‡∞¶‡±ä‡∞∞‡∞ø‡∞ï‡∞ø‡∞® ‡∞ó‡±ä‡∞™‡±ç‡∞™ ‡∞µ‡∞∞‡∞Ç ‡∞®‡±Å‡∞µ‡±ç‡∞µ‡±á ‡∞Ö‡∞Æ‡±ç‡∞Æ‡∞æ.',
      '‡∞®‡±Ä‡∞µ‡±Å ‡∞Ö‡∞≤‡∞∏‡∞ø‡∞®‡∞™‡±Å‡∞°‡±Å ‡∞®‡±á‡∞®‡±Å ‡∞è‡∞Æ‡∞ø ‡∞ö‡±á‡∞Ø‡∞≤‡±á‡∞ï‡∞™‡±ã‡∞Ø‡∞ø‡∞®‡∞æ, ‡∞®‡±Ä ‡∞ö‡∞ø‡∞∞‡±Å‡∞®‡∞µ‡±ç‡∞µ‡±Å ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞∞‡±ã‡∞ú‡±Å ‡∞™‡±ç‡∞∞‡∞Ø‡∞§‡±ç‡∞®‡∞ø‡∞∏‡±ç‡∞§‡∞æ‡∞®‡±Å.',
      '‡∞Ö‡∞Æ‡±ç‡∞Æ, ‡∞®‡±Ä ‡∞Æ‡±Å‡∞¶‡±ç‡∞¶‡±Å ‡∞Æ‡∞æ‡∞ü‡∞≤‡±Å ‡∞á‡∞Ç‡∞ï‡∞æ ‡∞®‡∞æ ‡∞Æ‡∞®‡∞∏‡±Å ‡∞≤‡±ã ‡∞ö‡±Ü‡∞Æ‡∞ü‡∞≤‡±ç‡∞≤‡∞æ ‡∞§‡∞°‡±Å‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞Ø‡∞ø.',
      '‡∞®‡∞æ ‡∞ö‡∞ø‡∞®‡±ç‡∞® ‡∞µ‡∞ø‡∞ú‡∞Ø‡∞Ç ‡∞≤‡±ã ‡∞ï‡±Ç‡∞°‡∞æ ‡∞®‡±Ä ‡∞π‡∞∞‡±ç‡∞∑‡∞Ç, ‡∞®‡±Ä ‡∞Ö‡∞≠‡∞ø‡∞Æ‡∞æ‡∞®‡∞Ç ‡∞®‡∞æ‡∞ï‡±Å ‡∞¨‡∞≤‡∞Æ‡∞ø‡∞ö‡±ç‡∞ö‡∞æ‡∞Ø‡∞ø.',
      '‡∞®‡±Ä ‡∞Ü‡∞∂‡±Ä‡∞∞‡±ç‡∞µ‡∞æ‡∞¶‡∞Æ‡±á ‡∞®‡∞æ ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ó‡∞Ç ‡∞µ‡±Ü‡∞≤‡∞ø‡∞ó‡∞ø‡∞Ç‡∞ö‡±á ‡∞¶‡±Ä‡∞™‡∞Ç.',
      '‡∞á‡∞ï ‡∞é‡∞Ç‡∞§ ‡∞ö‡±Ü‡∞™‡±ç‡∞™‡∞ø‡∞®‡∞æ ‡∞§‡∞ï‡±ç‡∞ï‡±Å‡∞µ‡±á... ‡∞Ö‡∞Ø‡∞ø‡∞®‡∞æ ‡∞í‡∞ï‡±ç‡∞ï ‡∞Æ‡∞æ‡∞ü: "I Love You Amma üíõ"',
      '‡∞à ‡∞™‡±ç‡∞∞‡∞§‡±ç‡∞Ø‡±á‡∞ï ‡∞∞‡±ã‡∞ú‡±Å‡∞®, ‡∞®‡±Ä‡∞ï‡∞ø ‡∞®‡∞æ ‡∞ö‡∞ø‡∞®‡±ç‡∞® ‡∞™‡±ç‡∞∞‡∞Ø‡∞§‡±ç‡∞®‡∞Ç...',
      "‡∞ú‡∞®‡±ç‡∞Æ‡∞¶‡∞ø‡∞® ‡∞∂‡±Å‡∞≠‡∞æ‡∞ï‡∞æ‡∞Ç‡∞ï‡±ç‡∞∑‡∞≤‡±Å ‡∞Ö‡∞Æ‡±ç‡∞Æ‡∞æ! ‡∞®‡±Ä ‡∞™‡±ç‡∞∞‡±á‡∞Æ‡∞ï‡±Å ‡∞ï‡±É‡∞§‡∞ú‡±ç‡∞û‡∞§‡∞ó‡∞æ... ‚ù§Ô∏è"
      '‡∞Ö‡∞Æ‡±ç‡∞Æ‡∞ï‡±Å ‡∞™‡±ç‡∞∞‡±á‡∞Æ‡∞§‡±ã, ‡∞®‡±Ä ‡∞¨‡∞ø‡∞°‡±ç‡∞° üôè'
];

export default function StoryGift() {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [paused, setPaused] = useState(false);
  const messageRef = useRef(null);

  useEffect(() => {
    const interval = setInterval(() => {
      if (!paused) {
        setCurrentIndex((prevIndex) => {
          if (prevIndex === messages.length - 1) {
            setTimeout(() => confetti({ particleCount: 300, spread: 180 }), 800);
            return prevIndex;
          }
          return prevIndex + 1;
        });
      }
    }, 4500);
    return () => clearInterval(interval);
  }, [paused]);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-pink-200 via-yellow-100 to-purple-200 p-6">
      <div className="relative max-w-xl w-full text-center">
        <div className="absolute top-0 right-0 m-4">
          <button
            onClick={() => setPaused(!paused)}
            className="bg-white/80 backdrop-blur-md px-4 py-2 text-sm rounded-full shadow-md hover:bg-white"
          >
            {paused ? "‚ñ∂Ô∏è Resume" : "‚è∏ Pause"}
          </button>
        </div>

        <div
          ref={messageRef}
          className="bg-white/80 rounded-3xl p-10 shadow-xl border-4 border-white animate-fadeIn text-xl sm:text-2xl md:text-3xl font-semibold text-gray-700 backdrop-blur-md"
        >
          <p className="transition-all duration-700 ease-in-out">
            {messages[currentIndex]}
          </p>
        </div>

        <img
          src="/c150b775-7122-49f6-b7be-acfdd62d1cc6.png"
          alt="Gift surprise"
          className="w-28 sm:w-36 mx-auto mt-8 animate-bounce drop-shadow-xl"
        />

        {/* Floating animations */}
        <div className="absolute inset-0 overflow-hidden pointer-events-none">
          <div className="absolute top-0 left-0 w-full h-full animate-pulse">
            <div className="w-4 h-4 bg-pink-400 rounded-full absolute animate-float delay-100" style={{ top: "10%", left: "20%" }}></div>
            <div className="w-3 h-3 bg-yellow-300 rounded-full absolute animate-float delay-300" style={{ top: "40%", left: "80%" }}></div>
            <div className="w-5 h-5 bg-purple-300 rounded-full absolute animate-float delay-500" style={{ top: "70%", left: "50%" }}></div>
          </div>
        </div>
      </div>

      <style jsx>{`
        @keyframes float {
          0% { transform: translateY(0px); opacity: 0.7; }
          50% { transform: translateY(-20px); opacity: 1; }
          100% { transform: translateY(0px); opacity: 0.7; }
        }
        .animate-float {
          animation: float 4s ease-in-out infinite;
        }
        .animate-fadeIn {
          animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
          0% { opacity: 0; }
          100% { opacity: 1; }
        }
      `}</style>
    </div>
  );
}
